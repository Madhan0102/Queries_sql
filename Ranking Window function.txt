WITH Latest_data as (
SELECT ProductID,StandardCost,ModifiedDate,
ROW_NUMBER() OVER(PARTITION BY ProductID ORDER BY ModifiedDate DESC) AS Rno
FROM Production.ProductCostHistory)

SELECT * FROM Latest_data WHERE Rno = 1

SELECT *,
RANK() OVER(PARTITION BY DEPARTMENT_ID ORDER BY SALARY DESC) AS Rank,
DENSE_RANK() OVER(PARTITION BY DEPARTMENT_ID ORDER BY SALARY DESC) AS DenseRank
FROM employees

SELECT *,
NTILE(10) OVER(ORDER BY SALARY DESC) AS BUCKET
FROM employees

SELECT *,
RANK() OVER Win AS Rank,
DENSE_RANK() OVER Win AS DenseRank
FROM employees
WINDOW Win as (PARTITION BY DEPARTMENT_ID ORDER BY SALARY DESC)